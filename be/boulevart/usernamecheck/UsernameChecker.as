package be.boulevart.usernamecheck {	import flash.events.Event;	import flash.events.EventDispatcher;	import flash.events.IOErrorEvent;	import flash.net.URLLoader;	import flash.net.URLRequest;	import com.adobe.utils.StringUtil;	import be.boulevart.usernamecheck.events.UsernameCheckEvent;		/**	 * @author joris	 */	public class UsernameChecker extends EventDispatcher {		public function UsernameChecker() {		}		/**		 * Check if username on a site exists		 * @param username username to check		 * @param websiteName name of website to check, for example 'facebook', 'lastfm', 'youtube'		 */		public function check(username : String, websiteName : String ) : void {			var serviceURL : String = 'http://www.usernamecheck.com/check/';						serviceURL += websiteName.toLowerCase() + "/" + username						var loader : URLLoader = new URLLoader()						var request : URLRequest = new URLRequest(serviceURL)						loader.addEventListener(Event .COMPLETE , onResponse)			loader.addEventListener(IOErrorEvent.IO_ERROR , onIOError); 			loader.load(request)		}		private function onResponse(event : Event) : void {			try {				var result : String = XMLList(String(event.target.data).substr(2)).toString()				result = StringUtil.trim(result)				if(result == "available") {					dispatchEvent(new UsernameCheckEvent(UsernameCheckEvent.USERNAME_AVAILABLE))				}else if(result == "taken") {					dispatchEvent(new UsernameCheckEvent(UsernameCheckEvent.USERNAME_TAKEN))				}			}catch (error : Error) {				dispatchEvent(new UsernameCheckEvent(UsernameCheckEvent.ON_ERROR , "Error on search: " + error.message))			}		}		private function onIOError(event : IOErrorEvent) : void {  			dispatchEvent(new UsernameCheckEvent(UsernameCheckEvent.ON_ERROR , "IOERROR: " + event.text))		} 	}}